此目录存放本周课后作业，可以在此文件添加作业设计思路和流程图等

#### 内容管理系统实现思路

##### 功能需求

- 登录注册；
- 可通过前端界面查看已有数据，并支持分页、查询；
- 可通过前端界面添加新数据，包括数据的名称、描述、时间等信息，并选择该数据所属的标签，并将数据保存到后端数据库中；
- 可通过前端界面编辑已有数据，并保存到后端数据库中；
- 可通过前端界面删除已有数据，并从后端数据库中移除该数据；
- 可通过前端界面查看标签列表，并支持添加、编辑和删除标签的功能；
- 可通过前端界面将标签添加到数据中，并支持多个标签的添加和删除；
- 在前端界面中时间的显示格式为 YYYY-MM-DD HH:mm:ss；
- 前端支持多语言切换功能，包括中文和英文。

#### 各功能模块拆解分析

##### 登录注册模块

**思路流程：**没有登录是无法进入页面，因此对于/路由下的内容首先需要进行认证才可以进入，否则统统跳转到登录页面。没有帐号可点击跳进注册页面，注册成功后返回登录页面进行登录。

**做法：**搭建登录表单和注册表单，从anti中选择合适的组件构建页面，调整CSS，使其达到满意的布局。设定Auth认证组件，判断本地是否已经存有token，若有显示其children，否则就跳去登录

**登录Form**添加onFinish事件，获取表单数据，利用接口向后台发起检验登录信息请求，通过**用户名和密码**作为参数发起POST请求拿到token信息将其保存到**Redux和Localstore**中。登陆后的页面的数据展示都需要校验token，去验证身份。

**注册Form**添加onFinish事件，获取表单数据，利用接口将注册的信息（用户名和密码）通过接口发送到后端保存到数据库中。后端的工作：拿到请求的数据，根据用户名和密码来生成一个该用户的用来存储在数据库的uuid。

##### 主界面模块

**思路：** 根据需求来看，页面的头部和侧边导航栏是不需要改变的，根据点击的导航栏，使得Content跳转到对应的功能模块，展示相应的内容和功能。头部主要有平台名称和设置，分别位于两端位置。其中设置的中英文是全局属性，因此该值由Redux可由进行管理。设置需要添加一个点击事件，修改中英文的切换，并将该值通过接口异步获取和保存到后端。

**做法：** 通过antd的组件Layout来搭建主页面，使用了Header，Sider以及Content三个内容，由于Content是随着导航栏的点击而变化的，这部分使用的是Router来实现，因此在Content的部分用二级路由入口<Outlet/>来占位，后续根据功能来插入。折叠导航栏可以通过组件的属性来操作。剩下就是调整CSS来完善样式。中英文的切换的值需要通过/lang接口POST和GET其值。将页面的中英文状态保存到后端。

##### 功能模块1：学习心得

**思路：**由于该部分没有参考样式，自己构想了一个界面：添加数据弹出modal，输入标题和内容，内容支持markdown语法，当输入内容时，下方实时展示最终的心得样式。使用List来展示心得，使用List自带的pagination属性实现内容的分类，每条心得最后面会显示更新时间和操作。

**做法：**使用了Rect-markdowm组件实现了输入框的内容转换为MarkDown内容展示出来。使用List来展示数据。由于没有学习心得的这部分后端接口。因此封装了Study的后端代码和相应的接口。modal与后面的功能类似，都是添加和编辑复用。

##### 功能模块2：数据管理

**思路：**分为上下两个内容区：1、上内容区为表单部分：主要用于数据的检索和查找信息的重置；2、下内容区为数据展示部分，有数据的增删改，数据信息的展示以及分页。

**做法：**页面的元素通过anti的组件库来搭建，调整CSS来修改页面的布局样式。上内容区的选择框的option需要通过/tags接口来获得标签名进而渲染到select中，select值就为tags的id。搜索时将value作为请求参数通过/data接口去获取数据。因为可以在渲染完成后可以**使用useEffect**发起请求拉取这部分数据。

只要点搜索就要发起请求获取数据，更新值，下方的展示区域也需要更新，因此上下两个区域很明显的兄弟组件，因此状态提升可以解决两者的数据交互。

增删改就根据功能走对应的接口完成。数据展示的部分不是uuid，是页面的自增编号，因此根据分页的不同，来生成。根据数据总数，每页数据数和当前数据的索引来计算并使用render函数来动态添加到编号中。

##### 功能模块3：标签管理

**思路：**一个区域，增删改和在页面中展示，以及批量删除，表格选框，选中多个都可删除。都需要走接口发送请求去完成。标签管理的数据，在数据管理的下拉框和modal中都有被使用，因此这部分封装成hook使其能够被复用。

**做法：**页面的元素通过antd的组件库来搭建，调整CSS来修改页面的布局样式。

##### 功能模块4：前端动态

**思路：**完成一个页面的布局，使用Echart画图，从后端拉取react，vue和angular的数据，将其置于图标上，右上角弄一个下载按钮，可将其下载为图片

**做法：**使用Echart画图，封装下载数据的接口。利用滑动窗口去得到每七天的一个平均下载量。将效果展示在页面上。

##### 问题
对代码进行打包后，对dist目录发起http服务，打开的页面不能与后端接口交互
**排查原因：** 跨域问题
**解决办法：** 后端添加了允许跨域的设置
**疑惑：** 前端Http-server发起的主机，端口和协议都与后端一致，跨域问题是因为中间出现了地址转移吗
由于开发环境的域名是利用了vite的代理进行了设置，因此在开发环境下，向后端发起请求时，前端访问出去的域名和后端是同域名下的，没有跨域问题。而在生产环境下，并没有走代理，而且打包的静态资源也没有部署到后端，因此，既是只对dist发起服务时，和后端的域名也不是同一的。因此跨域问题是存在的。
**一些解决办法** ：用一些代理转发，去除跨域问题：例如whistle，nginx；或者将静态资源部署到后端。
